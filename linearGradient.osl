float scalarProj(vector a, vector b) {
  return dot(a, b) / dot(b, b);
}

shader linearGradient(
  point Origin = point(-1.0, 0.0, 0.0),
  point Dest = point(1.0, 0.0, 0.0),
  point Point = P,

  output float Fac = 0.0,
  output float Dot = 0.0,
  output point Vector = 0.0) {
  
  point b = Origin - Dest;
  Dot = scalarProj(Origin - Point, b);
  Fac = clamp(Dot, 0.0, 1.0);
  Vector = b * Dot;
}